Central_control_topic å°ˆæ¡ˆæ¶æ§‹ç¸½è¦½ï¼ˆè¡¨æ ¼æ•´ç†ï¼‰

ğŸ“˜ å°ˆæ¡ˆæª”æ¡ˆåŠŸèƒ½ç¸½è¡¨

config.py	å…¨åŸŸè¨­å®šæª”	MySQL é€£ç·šåƒæ•¸ã€åœ°åœ–å¤§å°ã€å›ºå®šéšœç¤™ç‰©	æä¾›è¨­å®šçµ¦ 	database.py èˆ‡ path_planner.py
database.py	èˆ‡ MySQL é€šè¨Šã€è³‡æ–™ CRUD	æ›´æ–°è»Šè¼›ä½ç½®ã€æŸ¥è©¢å…¶ä»–è»Šè¼›ã€æŸ¥ä»»å‹™	è¢« app.py å‘¼å«
path_planner.py	A* è·¯å¾‘è¦åŠƒã€å¤šè»Šé¿è®“	A* æœå°‹ã€éšœç¤™ç”Ÿæˆã€ID å„ªå…ˆé¿è®“			è¢« app.py å‘¼å«
app.py	Flask ä¸»ä¼ºæœå™¨ï¼ˆä¸­æ§å¿ƒè‡Ÿï¼‰	æ¥æ”¶ ESP32 ä¸Šå‚³ä½ç½®ã€å›å‚³ä¸‹ä¸€æ­¥åº§æ¨™ã€ä»»å‹™æŒ‡æ´¾	æ•´åˆ database.pyã€path_planner.py
requirements.txt	å¥—ä»¶æ¸…å–®	flaskã€mysql-connector-python			å®‰è£ä¾è³´


ğŸ“˜ config.py è©³ç´°åŠŸèƒ½è¡¨

MYSQL_CONFIG	MySQL ç™»å…¥è³‡è¨Š		database.py
MAP_WIDTHï¼MAP_HEIGHT	å€‰åº«åœ°åœ–å¤§å°	path_planner.py
STATIC_OBSTACLES	å›ºå®šéšœç¤™ç‰©	path_planner.pyï¼ˆåœ°åœ–éšœç¤™å»ºç«‹ï¼‰


ğŸ“˜ database.py åŠŸèƒ½è¡¨

update_vehicle()	æ›´æ–°è»Šè¼›ä½ç½®èˆ‡ç‹€æ…‹åˆ°è³‡æ–™åº«	ç„¡	app.py
get_other_vehicles()	æŸ¥è©¢é™¤äº†è‡ªå·±ä»¥å¤–çš„è»Š	list(dict)	app.py
get_vehicle_task()	æŸ¥è©¢è»Šè¼›å°šæœªå®Œæˆçš„ä»»å‹™	dict æˆ– None	app.py


ğŸ“˜ path_planner.py åŠŸèƒ½è¡¨

heuristic()	A* å•é¡Œä¸­çš„ä¼°è¨ˆå‡½å¼	æ›¼å“ˆé “è·é›¢					A* å…§éƒ¨
build_obstacle_map()	å»ºç«‹éšœç¤™åœ°åœ–	åŒ…å«å›ºå®šéšœç¤™+å…¶ä»–è»Šä½ç½®				app.py
a_star()	A* æœå°‹è·¯å¾‘	å›å‚³åº§æ¨™æ¸…å–®ï¼ˆæœ€ä½³è·¯å¾‘ï¼‰				app.py
should_yield()	å¤šè»Š ID å„ªå…ˆé¿è®“	ID å°è€…å„ªå…ˆï¼Œä¸å°å¿ƒç¢°æ’æ›´å° ID è»Š â†’ åœä¸‹	app.py


ğŸ“˜ app.py Flask API æµç¨‹è¡¨

/update	POST	ESP32 ä¸Šå‚³åº§æ¨™ â†’ ä¸­æ§è¨ˆç®—ä¸‹ä¸€æ­¥	{"next_x": ?, "next_y": ?}
/	GET	æ¸¬è©¦ä¼ºæœå™¨æ˜¯å¦é‹ä½œ			å­—ä¸²




ESP32 è»Šè¼›
    â”‚
    â”‚ POST /update {id, x, y, battery, status}
    â–¼
Flask app.py
    â”‚   1. æ›´æ–°è»Šè¼›ä½ç½®åˆ° MySQL
    â–¼
database.py
    â”‚   update_vehicle()
    â–¼
MySQL
    â”‚
    â”‚ è¿”å›æˆåŠŸ
    â–¼
Flask app.py
    â”‚
    â”‚ 2. æŸ¥è©¢å…¶ä»–è»Šè¼›ä½ç½®
    â–¼
database.py â†’ MySQL â†’ å›å‚³è»Šè¼›åˆ—è¡¨
    â”‚
    â–¼
Flask app.py
    â”‚
    â”‚ 3. æª¢æŸ¥æ˜¯å¦è¦è®“è·¯ (should_yield)
    â–¼
path_planner.py
    â”‚
    â”‚ è‹¥éœ€è®“è·¯ï¼šå›å‚³åŸåœ°ä¸å‹•
    â–¼
Flask å›å‚³ next_x=x, next_y=y
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ï¼ˆè‹¥ä¸éœ€è®“è·¯ï¼Œç¹¼çºŒï¼‰
 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Flask app.py
    â”‚
    â”‚ 4. æŸ¥è©¢è©²è»Šçš„ä»»å‹™ (get_vehicle_task)
    â–¼
database.py â†’ MySQL â†’ å›å‚³ä»»å‹™
    â”‚
    â–¼
Flask app.py
    â”‚
    â”‚ 5. å»ºå‡ºéšœç¤™ç‰©ï¼ˆå›ºå®š + è»Šè¼›ä½ç½®ï¼‰
    â–¼
path_planner.build_obstacle_map()
    â”‚
    â–¼
Flask app.py
    â”‚
    â”‚ 6. A* è¨ˆç®—è·¯å¾‘
    â–¼
path_planner.a_star()
    â”‚
    â–¼
Flask app.py
    â”‚
    â”‚ 7. å›å‚³ä¸‹ä¸€åº§æ¨™çµ¦è»Šå­
    â–¼
ESP32 move to new (x,y)